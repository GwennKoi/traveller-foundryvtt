{
  "name": "AddSkill",
  "type": "script",
  "command": "// Add a skill to a character sheet.\n// If the level is specified, skill is set to this level if higher.\n// If a level is not specified, then the skill is incremened by 1.\n\nlet skillId = scope.skill;\nlet specId = null;\nlet level = scope.level;\nlet context = scope.context;\n\nif (skillId.indexOf(\".\") > -1) {\n  skillId = scope.skill.split(\".\")[0];\n  specId = scope.skill.split(\".\")[1];\n}\n\n\nfor (let t of canvas.tokens.controlled) {\n    let actor = t.actor;\n    if (actor) {\n      let skill = actor.system.skills[skillId];\n      let text = \"\";\n      let skillName = actor.getSkillLabel(scope.skill, false);\n\n      if (!skill.trained) {\n          skill.trained = true;\n          text += `<b>${skillName}</b> is now trained.<br/>`;\n      }\n      if (level === undefined  && skill.value < 4) {\n          skill.value += 1;\n          text += `Incrementing <b>${skillName}</b> to ${skill.value}.`;\n      } else if (level > skill.value) {\n          skill.value = level;\n          text += `Setting <b>${skillName}</b> to ${level}.`;\n      } else {\n          text += `<b>${skillName}</b> is unchanged.`;\n      }\n      actor.update({\"system.skills\": actor.system.skills});\n\n\n      let html = `<div class=\"chat-package\"><h3>${actor.name}</h3>`;\n      if (context) {\n        html += `<p>${context}</p>`;\n      }\n      html += `<p>${text}</p>`;\n\n      html += `</div>`;\n\n      \n      let chatData = {\n        speaker: ChatMessage.getSpeaker({actor: actor}),\n        content: html\n      };\n      ChatMessage.create(chatData, {});\n      \n\n    }\n}",
  "img": "systems/mgt2e/icons/macros/macro.svg",
  "author": "mhUjqDVicnwIUaiq",
  "scope": "global",
  "folder": null,
  "ownership": {
    "default": 0,
    "mhUjqDVicnwIUaiq": 3
  },
  "flags": {},
  "_stats": {
    "compendiumSource": null,
    "duplicateSource": null,
    "coreVersion": "12.331",
    "systemId": "mgt2e",
    "systemVersion": "0.11.6.13-DEV",
    "createdTime": 1739743534549,
    "modifiedTime": 1739920397411,
    "lastModifiedBy": "mhUjqDVicnwIUaiq"
  },
  "_id": "GZyTJeasSmua10Lr",
  "sort": 200000,
  "_key": "!macros!GZyTJeasSmua10Lr"
}
